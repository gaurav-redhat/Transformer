<svg width="900" height="550" viewBox="0 0 900 550" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <rect x="0" y="0" width="900" height="50" fill="#FF5722"/>
  <text x="450" y="33" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="white" text-anchor="middle">Positional Encoding Evolution</text>
  
  <!-- Sinusoidal (2017) -->
  <rect x="30" y="70" width="270" height="220" rx="10" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="165" y="100" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565C0" text-anchor="middle">Sinusoidal (2017)</text>
  
  <text x="50" y="130" font-family="Courier New, monospace" font-size="10" fill="#333">PE(pos,2i) = sin(pos/10000^(2i/d))</text>
  <text x="50" y="150" font-family="Courier New, monospace" font-size="10" fill="#333">PE(pos,2i+1) = cos(pos/10000^(2i/d))</text>
  
  <rect x="50" y="170" width="220" height="50" fill="#BBDEFB" rx="5"/>
  <text x="160" y="192" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Pros: No training needed</text>
  <text x="160" y="208" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Generalizes to longer sequences</text>
  
  <rect x="50" y="230" width="220" height="40" fill="#FFCDD2" rx="5"/>
  <text x="160" y="255" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Cons: Absolute positions only</text>
  
  <!-- Learned (2018) -->
  <rect x="315" y="70" width="270" height="220" rx="10" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
  <text x="450" y="100" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2E7D32" text-anchor="middle">Learned (2018 - GPT/BERT)</text>
  
  <text x="335" y="130" font-family="Courier New, monospace" font-size="10" fill="#333">PE = nn.Embedding(max_len, d)</text>
  <text x="335" y="150" font-family="Courier New, monospace" font-size="10" fill="#333">output = token_emb + PE[position]</text>
  
  <rect x="335" y="170" width="220" height="50" fill="#C8E6C9" rx="5"/>
  <text x="445" y="192" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Pros: Can learn optimal encoding</text>
  <text x="445" y="208" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Flexible for the task</text>
  
  <rect x="335" y="230" width="220" height="40" fill="#FFCDD2" rx="5"/>
  <text x="445" y="255" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Cons: Fixed max length!</text>
  
  <!-- RoPE (2023+) -->
  <rect x="600" y="70" width="270" height="220" rx="10" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <text x="735" y="100" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#E65100" text-anchor="middle">RoPE (2023+ Modern)</text>
  
  <text x="620" y="130" font-family="Courier New, monospace" font-size="10" fill="#333">Rotate Q,K by position angle</text>
  <text x="620" y="150" font-family="Courier New, monospace" font-size="10" fill="#333">f(q,m) = q * e^(i*m*theta)</text>
  
  <rect x="620" y="170" width="230" height="70" fill="#FFE0B2" rx="5"/>
  <text x="735" y="192" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Pros: Relative positions!</text>
  <text x="735" y="208" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Extrapolates to longer contexts</text>
  <text x="735" y="224" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">Decays with distance (natural)</text>
  
  <rect x="620" y="250" width="230" height="30" fill="#C8E6C9" rx="5"/>
  <text x="735" y="270" font-family="Arial, sans-serif" font-size="10" fill="#2E7D32" text-anchor="middle">Used in: LLaMA, Mistral, GPT-4</text>
  
  <!-- RoPE Math Detail -->
  <rect x="30" y="310" width="840" height="220" rx="10" fill="#FAFAFA" stroke="#E0E0E0" stroke-width="2"/>
  <text x="450" y="340" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333" text-anchor="middle">RoPE: Rotary Position Embedding Math</text>
  
  <!-- Matrix visualization -->
  <text x="60" y="380" font-family="Arial, sans-serif" font-size="12" fill="#333">For each pair of dimensions (2i, 2i+1), apply rotation:</text>
  
  <text x="60" y="420" font-family="Courier New, monospace" font-size="12" fill="#333">[q_2i  ]     [cos(m*theta_i)  -sin(m*theta_i)] [q_2i  ]</text>
  <text x="60" y="440" font-family="Courier New, monospace" font-size="12" fill="#333">[q_2i+1]  =  [sin(m*theta_i)   cos(m*theta_i)] [q_2i+1]</text>
  
  <text x="60" y="475" font-family="Arial, sans-serif" font-size="11" fill="#666">theta_i = 10000^(-2i/d)</text>
  <text x="60" y="495" font-family="Arial, sans-serif" font-size="11" fill="#666">m = position in sequence</text>
  
  <!-- Key insight -->
  <rect x="500" y="375" width="350" height="130" rx="8" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
  <text x="675" y="405" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2E7D32" text-anchor="middle">Key Insight</text>
  <text x="520" y="435" font-family="Arial, sans-serif" font-size="11" fill="#333">When computing Q*K^T:</text>
  <text x="520" y="460" font-family="Arial, sans-serif" font-size="11" fill="#333">f(q,m)^T * f(k,n) = f(q,k, m-n)</text>
  <text x="520" y="485" font-family="Arial, sans-serif" font-size="11" fill="#666">Position becomes RELATIVE! (m-n)</text>
</svg>
