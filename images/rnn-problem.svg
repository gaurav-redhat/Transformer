<svg width="900" height="500" viewBox="0 0 900 500" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <rect x="0" y="0" width="900" height="50" fill="#F44336"/>
  <text x="450" y="33" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="white" text-anchor="middle">The RNN Problem: Sequential Bottleneck</text>
  
  <!-- RNN Chain -->
  <text x="450" y="85" font-family="Arial, sans-serif" font-size="14" fill="#666" text-anchor="middle">RNN processes tokens one-by-one: Cannot parallelize!</text>
  
  <!-- Input tokens -->
  <rect x="50" y="120" width="60" height="40" rx="5" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="80" y="145" font-family="Arial, sans-serif" font-size="12" fill="#1565C0" text-anchor="middle">The</text>
  
  <rect x="150" y="120" width="60" height="40" rx="5" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="180" y="145" font-family="Arial, sans-serif" font-size="12" fill="#1565C0" text-anchor="middle">cat</text>
  
  <rect x="250" y="120" width="60" height="40" rx="5" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="280" y="145" font-family="Arial, sans-serif" font-size="12" fill="#1565C0" text-anchor="middle">sat</text>
  
  <rect x="350" y="120" width="60" height="40" rx="5" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="380" y="145" font-family="Arial, sans-serif" font-size="12" fill="#1565C0" text-anchor="middle">on</text>
  
  <rect x="450" y="120" width="60" height="40" rx="5" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="480" y="145" font-family="Arial, sans-serif" font-size="12" fill="#1565C0" text-anchor="middle">the</text>
  
  <rect x="550" y="120" width="60" height="40" rx="5" fill="#E3F2FD" stroke="#2196F3" stroke-width="2"/>
  <text x="580" y="145" font-family="Arial, sans-serif" font-size="12" fill="#1565C0" text-anchor="middle">mat</text>
  
  <!-- Hidden states -->
  <rect x="50" y="200" width="60" height="50" rx="8" fill="#FF9800"/>
  <text x="80" y="230" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">h1</text>
  
  <rect x="150" y="200" width="60" height="50" rx="8" fill="#FF9800"/>
  <text x="180" y="230" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">h2</text>
  
  <rect x="250" y="200" width="60" height="50" rx="8" fill="#FF9800"/>
  <text x="280" y="230" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">h3</text>
  
  <rect x="350" y="200" width="60" height="50" rx="8" fill="#FF9800"/>
  <text x="380" y="230" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">h4</text>
  
  <rect x="450" y="200" width="60" height="50" rx="8" fill="#FF9800"/>
  <text x="480" y="230" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">h5</text>
  
  <rect x="550" y="200" width="60" height="50" rx="8" fill="#FF9800"/>
  <text x="580" y="230" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white" text-anchor="middle">h6</text>
  
  <!-- Arrows between hidden states -->
  <line x1="110" y1="225" x2="145" y2="225" stroke="#F44336" stroke-width="3"/>
  <polygon points="142,220 152,225 142,230" fill="#F44336"/>
  
  <line x1="210" y1="225" x2="245" y2="225" stroke="#F44336" stroke-width="3"/>
  <polygon points="242,220 252,225 242,230" fill="#F44336"/>
  
  <line x1="310" y1="225" x2="345" y2="225" stroke="#F44336" stroke-width="3"/>
  <polygon points="342,220 352,225 342,230" fill="#F44336"/>
  
  <line x1="410" y1="225" x2="445" y2="225" stroke="#F44336" stroke-width="3"/>
  <polygon points="442,220 452,225 442,230" fill="#F44336"/>
  
  <line x1="510" y1="225" x2="545" y2="225" stroke="#F44336" stroke-width="3"/>
  <polygon points="542,220 552,225 542,230" fill="#F44336"/>
  
  <!-- Time labels -->
  <text x="80" y="275" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">t=1</text>
  <text x="180" y="275" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">t=2</text>
  <text x="280" y="275" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">t=3</text>
  <text x="380" y="275" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">t=4</text>
  <text x="480" y="275" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">t=5</text>
  <text x="580" y="275" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">t=6</text>
  
  <!-- Vanishing Gradient Visualization -->
  <rect x="650" y="100" width="230" height="170" rx="10" fill="#FFEBEE" stroke="#F44336" stroke-width="2"/>
  <text x="765" y="130" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#C62828" text-anchor="middle">Vanishing Gradient</text>
  
  <!-- Gradient strength bars -->
  <rect x="670" y="150" width="180" height="18" fill="#EF5350"/>
  <text x="760" y="163" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">Gradient at h6: 1.0</text>
  
  <rect x="670" y="175" width="140" height="18" fill="#E57373"/>
  <text x="740" y="188" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">h5: 0.8</text>
  
  <rect x="670" y="200" width="80" height="18" fill="#EF9A9A"/>
  <text x="710" y="213" font-family="Arial, sans-serif" font-size="10" fill="#333" text-anchor="middle">h4: 0.4</text>
  
  <rect x="670" y="225" width="30" height="18" fill="#FFCDD2"/>
  <text x="720" y="238" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">h1: 0.01</text>
  
  <!-- Problem boxes -->
  <rect x="50" y="310" width="250" height="80" rx="8" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
  <text x="175" y="340" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#E65100" text-anchor="middle">Problem 1: Sequential</text>
  <text x="175" y="365" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Must wait for h1 to compute h2</text>
  <text x="175" y="380" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">No GPU parallelization!</text>
  
  <rect x="320" y="310" width="250" height="80" rx="8" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="445" y="340" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#C2185B" text-anchor="middle">Problem 2: Vanishing Gradient</text>
  <text x="445" y="365" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Early tokens get tiny gradients</text>
  <text x="445" y="380" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Learning long dependencies fails</text>
  
  <rect x="590" y="310" width="250" height="80" rx="8" fill="#EDE7F6" stroke="#9C27B0" stroke-width="2"/>
  <text x="715" y="340" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7B1FA2" text-anchor="middle">Problem 3: Information Loss</text>
  <text x="715" y="365" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">h6 must encode ALL past info</text>
  <text x="715" y="380" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Fixed-size bottleneck</text>
  
  <!-- Math formulas -->
  <rect x="50" y="410" width="800" height="75" rx="8" fill="#F5F5F5" stroke="#E0E0E0"/>
  <text x="450" y="435" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#333" text-anchor="middle">RNN Equations:</text>
  <text x="450" y="460" font-family="Courier New, monospace" font-size="12" fill="#333" text-anchor="middle">h_t = tanh(W_hh * h_(t-1) + W_xh * x_t + b)     Gradient: dL/dh_1 = (W_hh)^T * ... * (W_hh)^T * dL/dh_n</text>
  <text x="450" y="478" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">If max eigenvalue of W_hh is less than 1, gradients vanish exponentially!</text>
</svg>
