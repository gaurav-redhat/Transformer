<svg width="850" height="500" viewBox="0 0 850 500" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <rect x="0" y="0" width="850" height="45" fill="#9C27B0"/>
  <text x="425" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="white" text-anchor="middle">Multi-Head Attention</text>
  
  <!-- Formula -->
  <rect x="125" y="55" width="600" height="40" rx="6" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2"/>
  <text x="425" y="82" font-family="Arial, sans-serif" font-size="13" fill="#7B1FA2" text-anchor="middle">MultiHead(Q, K, V) = Concat(head1, ..., headh) W^O where headi = Attention(QWiQ, KWiK, VWiV)</text>
  
  <!-- Input -->
  <rect x="40" y="180" width="70" height="120" rx="6" fill="#ECEFF1" stroke="#607D8B" stroke-width="2"/>
  <text x="75" y="235" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#455A64" text-anchor="middle">Input</text>
  <text x="75" y="255" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">(Q,K,V)</text>
  
  <!-- Linear layers (input) -->
  <rect x="150" y="150" width="55" height="35" rx="5" fill="#E1F5FE" stroke="#03A9F4" stroke-width="2"/>
  <text x="177" y="172" font-family="Arial, sans-serif" font-size="10" fill="#0277BD" text-anchor="middle">Linear</text>
  
  <rect x="150" y="200" width="55" height="35" rx="5" fill="#E1F5FE" stroke="#03A9F4" stroke-width="2"/>
  <text x="177" y="222" font-family="Arial, sans-serif" font-size="10" fill="#0277BD" text-anchor="middle">Linear</text>
  
  <rect x="150" y="250" width="55" height="35" rx="5" fill="#E1F5FE" stroke="#03A9F4" stroke-width="2"/>
  <text x="177" y="272" font-family="Arial, sans-serif" font-size="10" fill="#0277BD" text-anchor="middle">Linear</text>
  
  <rect x="150" y="300" width="55" height="35" rx="5" fill="#E1F5FE" stroke="#03A9F4" stroke-width="2"/>
  <text x="177" y="322" font-family="Arial, sans-serif" font-size="10" fill="#0277BD" text-anchor="middle">Linear</text>
  
  <!-- Attention Heads -->
  <text x="330" y="130" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#666">h = 8 Parallel Attention Heads</text>
  
  <!-- Head 1 -->
  <rect x="260" y="150" width="90" height="50" rx="8" fill="#E91E63"/>
  <text x="305" y="172" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">Head 1</text>
  <text x="305" y="188" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">Attention</text>
  
  <!-- Head 2 -->
  <rect x="260" y="210" width="90" height="50" rx="8" fill="#2196F3"/>
  <text x="305" y="232" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">Head 2</text>
  <text x="305" y="248" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">Attention</text>
  
  <!-- Head 3 -->
  <rect x="260" y="270" width="90" height="50" rx="8" fill="#4CAF50"/>
  <text x="305" y="292" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">Head 3</text>
  <text x="305" y="308" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">Attention</text>
  
  <!-- Head h (8) -->
  <rect x="260" y="330" width="90" height="50" rx="8" fill="#FF9800"/>
  <text x="305" y="352" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white" text-anchor="middle">Head h</text>
  <text x="305" y="368" font-family="Arial, sans-serif" font-size="9" fill="white" text-anchor="middle">Attention</text>
  
  <!-- Dots between heads -->
  <text x="305" y="205" font-family="Arial, sans-serif" font-size="16" fill="#666" text-anchor="middle">...</text>
  
  <!-- Concat -->
  <rect x="420" y="195" width="90" height="130" rx="8" fill="#FCE4EC" stroke="#E91E63" stroke-width="2"/>
  <text x="465" y="255" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#C2185B" text-anchor="middle">Concat</text>
  <text x="465" y="275" font-family="Arial, sans-serif" font-size="9" fill="#666" text-anchor="middle">(n x h.dv)</text>
  
  <!-- Final Linear -->
  <rect x="570" y="220" width="90" height="70" rx="8" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
  <text x="615" y="250" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2E7D32" text-anchor="middle">Linear</text>
  <text x="615" y="270" font-family="Arial, sans-serif" font-size="10" fill="#666" text-anchor="middle">W^O</text>
  
  <!-- Output -->
  <rect x="720" y="220" width="80" height="70" rx="8" fill="#FFECB3" stroke="#FF9800" stroke-width="3"/>
  <text x="760" y="253" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#E65100" text-anchor="middle">Output</text>
  <text x="760" y="273" font-family="Arial, sans-serif" font-size="9" fill="#666" text-anchor="middle">(n x d)</text>
  
  <!-- Arrows: Input to Linear -->
  <line x1="115" y1="200" x2="145" y2="167" stroke="#666" stroke-width="2"/>
  <line x1="115" y1="230" x2="145" y2="217" stroke="#666" stroke-width="2"/>
  <line x1="115" y1="260" x2="145" y2="267" stroke="#666" stroke-width="2"/>
  <line x1="115" y1="290" x2="145" y2="317" stroke="#666" stroke-width="2"/>
  
  <!-- Arrows: Linear to Heads -->
  <line x1="210" y1="167" x2="255" y2="170" stroke="#E91E63" stroke-width="2"/>
  <line x1="210" y1="217" x2="255" y2="230" stroke="#2196F3" stroke-width="2"/>
  <line x1="210" y1="267" x2="255" y2="290" stroke="#4CAF50" stroke-width="2"/>
  <line x1="210" y1="317" x2="255" y2="350" stroke="#FF9800" stroke-width="2"/>
  
  <!-- Arrows: Heads to Concat -->
  <line x1="355" y1="175" x2="415" y2="220" stroke="#E91E63" stroke-width="2"/>
  <line x1="355" y1="235" x2="415" y2="245" stroke="#2196F3" stroke-width="2"/>
  <line x1="355" y1="295" x2="415" y2="275" stroke="#4CAF50" stroke-width="2"/>
  <line x1="355" y1="355" x2="415" y2="300" stroke="#FF9800" stroke-width="2"/>
  
  <!-- Arrows: Concat to Linear -->
  <line x1="515" y1="260" x2="565" y2="260" stroke="#666" stroke-width="2"/>
  <polygon points="560,255 570,260 560,265" fill="#666"/>
  
  <!-- Arrows: Linear to Output -->
  <line x1="665" y1="255" x2="715" y2="255" stroke="#666" stroke-width="2"/>
  <polygon points="710,250 720,255 710,260" fill="#666"/>
  
  <!-- Info Box -->
  <rect x="50" y="420" width="750" height="60" rx="8" fill="#F5F5F5" stroke="#E0E0E0"/>
  <text x="425" y="445" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333" text-anchor="middle">Why Multiple Heads?</text>
  <text x="425" y="465" font-family="Arial, sans-serif" font-size="11" fill="#666" text-anchor="middle">Each head can learn different aspects: syntax, semantics, coreference, etc. | dk = dv = d/h (512/8 = 64)</text>
</svg>